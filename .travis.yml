language: node_js
node_js:
  - "8"
script:
  - echo "Deploy!!"
install:
  - |
    if [ $TRAVIS_EVENT_TYPE != "push" ] || [ $TRAVIS_BRANCH != "master" ] ; then
      travis_terminate 0 ;
    fi
  - npm install -g firebase-tools
  - cd functions
  - npm install
  - cd ..
  - npm install uglify-js -g
  - cd public/js
  - uglifyjs --compree --mangle -- main.js -o mainX.js
  - uglifyjs --compree --mangle -- database.js -o databaseX.js
  - rm -rf main.js
  - rm -rf database.js
  - mv mainX.js main.js
  - mv databaseX.js database.js
after_success:
  - |
    if [ $TRAVIS_EVENT_TYPE == "push" ] && [ $TRAVIS_BRANCH == "master" ] ; then
      firebase deploy --project thoughtcache --token $FIREBASE_TOKEN ;
    fi